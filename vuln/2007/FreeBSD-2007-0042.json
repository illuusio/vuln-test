{
    "affected": [
        {
            "package": {
                "ecosystem": "FreeBSD:ports",
                "name": "samba"
            },
            "ranges": [
                {
                    "events": [
                        {
                            "introduced": "3.*,1"
                        },
                        {
                            "fixed": "3.0.25"
                        }
                    ],
                    "type": "ECOSYSTEM"
                },
                {
                    "events": [
                        {
                            "introduced": "3.*,1,1"
                        },
                        {
                            "fixed": "3.0.25,1"
                        }
                    ],
                    "type": "ECOSYSTEM"
                }
            ]
        },
        {
            "package": {
                "ecosystem": "FreeBSD:ports",
                "name": "ja-samba"
            },
            "ranges": [
                {
                    "events": [
                        {
                            "introduced": "3.*,1"
                        },
                        {
                            "fixed": "3.0.25"
                        }
                    ],
                    "type": "ECOSYSTEM"
                },
                {
                    "events": [
                        {
                            "introduced": "3.*,1,1"
                        },
                        {
                            "fixed": "3.0.25,1"
                        }
                    ],
                    "type": "ECOSYSTEM"
                }
            ]
        }
    ],
    "database_specific": {
        "cite": [
            "http://de5.samba.org/samba/security/CVE-2007-2444.html",
            "http://de5.samba.org/samba/security/CVE-2007-2446.html",
            "http://de5.samba.org/samba/security/CVE-2007-2447.html"
        ],
        "discovery": "2007-05-14T00:00:00Z",
        "references": {
            "cvename": [
                "CVE-2007-2444",
                "CVE-2007-2446",
                "CVE-2007-2447"
            ]
        },
        "vid": "3546a833-03ea-11dc-a51d-0019b95d4f14"
    },
    "details": "The Samba Team reports:\n\n> A bug in the local SID/Name translation routines may potentially\n> result in a user being able to issue SMB/CIFS protocol operations as\n> root.\n>\n> When translating SIDs to/from names using Samba local list of user and\n> group accounts, a logic error in the smbd daemon\\'s internal security\n> stack may result in a transition to the root user id rather than the\n> non-root user. The user is then able to temporarily issue SMB/CIFS\n> protocol operations as the root user. This window of opportunity may\n> allow the attacker to establish additional means of gaining root\n> access to the server.\n\n> Various bugs in Samba\\'s NDR parsing can allow a user to send\n> specially crafted MS-RPC requests that will overwrite the heap space\n> with user defined data.\n\n> Unescaped user input parameters are passed as arguments to /bin/sh\n> allowing for remote command execution.\n>\n> This bug was originally reported against the anonymous calls to the\n> SamrChangePassword() MS-RPC function in combination with the\n> \\\"username map script\\\" smb.conf option (which is not enabled by\n> default).\n>\n> After further investigation by Samba developers, it was determined\n> that the problem was much broader and impacts remote printer and file\n> share management as well. The root cause is passing unfiltered user\n> input provided via MS-RPC calls to /bin/sh when invoking externals\n> scripts defined in smb.conf. However, unlike the \\\"username map\n> script\\\" vulnerability, the remote file and printer management scripts\n> require an authenticated user session.\n",
    "id": "FreeBSD-2007-0042",
    "modified": "2008-09-26T00:00:00Z",
    "published": "2007-05-16T00:00:00Z",
    "references": [
        {
            "type": "REPORT",
            "url": "http://de5.samba.org/samba/security/CVE-2007-2444.html"
        },
        {
            "type": "REPORT",
            "url": "http://de5.samba.org/samba/security/CVE-2007-2446.html"
        },
        {
            "type": "REPORT",
            "url": "http://de5.samba.org/samba/security/CVE-2007-2447.html"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2007-2444"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2007-2446"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2007-2447"
        },
        {
            "type": "WEB",
            "url": "http://de5.samba.org/samba/security/CVE-2007-2444.html"
        },
        {
            "type": "WEB",
            "url": "http://de5.samba.org/samba/security/CVE-2007-2446.html"
        },
        {
            "type": "WEB",
            "url": "http://de5.samba.org/samba/security/CVE-2007-2447.html"
        }
    ],
    "schema_version": "1.7.0",
    "summary": "samba -- multiple vulnerabilities"
}
