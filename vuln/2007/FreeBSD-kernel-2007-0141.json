{
    "affected": [
        {
            "package": {
                "ecosystem": "FreeBSD:ports",
                "name": "FreeBSD"
            },
            "ranges": [
                {
                    "events": [
                        {
                            "introduced": "6.1"
                        },
                        {
                            "fixed": "6.1_12"
                        }
                    ],
                    "type": "ECOSYSTEM"
                },
                {
                    "events": [
                        {
                            "introduced": "6.0"
                        },
                        {
                            "fixed": "6.0_17"
                        }
                    ],
                    "type": "ECOSYSTEM"
                },
                {
                    "events": [
                        {
                            "introduced": "5.5"
                        },
                        {
                            "fixed": "5.5_15"
                        }
                    ],
                    "type": "ECOSYSTEM"
                }
            ]
        }
    ],
    "database_specific": {
        "discovery": "2007-01-11T00:00:00Z",
        "vid": "46b922a8-c69c-11db-9f82-000e0c2e438a"
    },
    "details": "Problem Description:\n====================\n\nIn multiple situations the host's jail rc.d(8) script does\nnot check if a path inside the jail file system structure is\na symbolic link before using the path. In particular this is\nthe case when writing the output from the jail start-up to\n/var/log/console.log and when mounting and unmounting file\nsystems inside the jail directory structure.\n\nImpact:\n=======\n\nDue to the lack of handling of potential symbolic links the\nhost's jail rc.d(8) script is vulnerable to \"symlink\nattacks\". By replacing /var/log/console.log inside the jail\nwith a symbolic link it is possible for the superuser (root)\ninside the jail to overwrite files on the host system outside\nthe jail with arbitrary content. This in turn can be used to\nexecute arbitrary commands with non-jailed superuser\nprivileges.\n\nSimilarly, by changing directory mount points inside the\njail file system structure into symbolic links, it may be\npossible for a jailed attacker to mount file systems which\nwere meant to be mounted inside the jail at arbitrary points\nin the host file system structure, or to unmount arbitrary\nfile systems on the host system.\n\nNOTE WELL: The above vulnerabilities occur only when a jail\nis being started or stopped using the host's jail rc.d(8)\nscript; once started (and until stopped), running jails\ncannot exploit this.\n\nWorkaround:\n===========\n\nIf the sysctl(8) variable security.jail.chflags\\_allowed is\nset to 0 (the default), setting the \"sunlnk\" system flag on\n/var, /var/log, /var/log/console.log, and all file system\nmount points and their parent directories inside the jail(s)\nwill ensure that the console log file and mount points are\nnot replaced by symbolic links. If this is done while jails\nare running, the administrator must check that an attacker\nhas not replaced any directories with symlinks after setting\nthe \"sunlnk\" flag.",
    "id": "FreeBSD-kernel-2007-0141",
    "modified": "2016-08-09T00:00:00Z",
    "published": "2007-02-27T00:00:00Z",
    "references": [
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2007-0166"
        },
        {
            "type": "ADVISORY",
            "url": "https://www.freebsd.org/security/advisories/FreeBSD-SA-07:01.jail.asc"
        }
    ],
    "schema_version": "1.7.0",
    "summary": "FreeBSD -- Jail rc.d script privilege escalation"
}
