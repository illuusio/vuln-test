{
    "affected": [
        {
            "package": {
                "ecosystem": "FreeBSD:ports",
                "name": "samba"
            },
            "ranges": [
                {
                    "events": [
                        {
                            "introduced": "3.*,1"
                        },
                        {
                            "fixed": "3.0.25"
                        }
                    ],
                    "type": "ECOSYSTEM"
                },
                {
                    "events": [
                        {
                            "introduced": "3.*,1,1"
                        },
                        {
                            "fixed": "3.0.25,1"
                        }
                    ],
                    "type": "ECOSYSTEM"
                }
            ]
        },
        {
            "package": {
                "ecosystem": "FreeBSD:ports",
                "name": "ja-samba"
            },
            "ranges": [
                {
                    "events": [
                        {
                            "introduced": "3.*,1"
                        },
                        {
                            "fixed": "3.0.25"
                        }
                    ],
                    "type": "ECOSYSTEM"
                },
                {
                    "events": [
                        {
                            "introduced": "3.*,1,1"
                        },
                        {
                            "fixed": "3.0.25,1"
                        }
                    ],
                    "type": "ECOSYSTEM"
                }
            ]
        }
    ],
    "database_specific": {
        "discovery": "2007-05-14T00:00:00Z",
        "vid": "3546a833-03ea-11dc-a51d-0019b95d4f14"
    },
    "details": "The Samba Team reports:\n\n> A bug in the local SID/Name translation routines may\n> potentially result in a user being able to issue SMB/CIFS\n> protocol operations as root.\n>\n> When translating SIDs to/from names using Samba local\n> list of user and group accounts, a logic error in the smbd\n> daemon's internal security stack may result in a\n> transition to the root user id rather than the non-root\n> user. The user is then able to temporarily issue SMB/CIFS\n> protocol operations as the root user. This window of\n> opportunity may allow the attacker to establish additional\n> means of gaining root access to the server.\n\n> Various bugs in Samba's NDR parsing can allow a user to\n> send specially crafted MS-RPC requests that will overwrite\n> the heap space with user defined data.\n\n> Unescaped user input parameters are passed as arguments\n> to /bin/sh allowing for remote command execution.\n>\n> This bug was originally reported against the anonymous\n> calls to the SamrChangePassword() MS-RPC function in\n> combination with the \"username map script\" smb.conf option\n> (which is not enabled by default).\n>\n> After further investigation by Samba developers, it was\n> determined that the problem was much broader and impacts\n> remote printer and file share management as well. The\n> root cause is passing unfiltered user input provided via\n> MS-RPC calls to /bin/sh when invoking externals scripts\n> defined in smb.conf. However, unlike the \"username map\n> script\" vulnerability, the remote file and printer\n> management scripts require an authenticated user\n> session.",
    "id": "FreeBSD-kernel-2007-0118",
    "modified": "2008-09-26T00:00:00Z",
    "published": "2007-05-16T00:00:00Z",
    "references": [
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2007-2444"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2007-2446"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2007-2447"
        },
        {
            "type": "WEB",
            "url": "http://de5.samba.org/samba/security/CVE-2007-2444.html"
        },
        {
            "type": "WEB",
            "url": "http://de5.samba.org/samba/security/CVE-2007-2446.html"
        },
        {
            "type": "WEB",
            "url": "http://de5.samba.org/samba/security/CVE-2007-2447.html"
        }
    ],
    "schema_version": "1.7.0",
    "summary": "samba -- multiple vulnerabilities"
}
