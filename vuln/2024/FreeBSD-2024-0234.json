{
    "affected": [
        {
            "package": {
                "ecosystem": "FreeBSD:kernel",
                "name": "FreeBSD-kernel"
            },
            "ranges": [
                {
                    "events": [
                        {
                            "introduced": "14.1"
                        },
                        {
                            "fixed": "14.1_3"
                        }
                    ],
                    "type": "ECOSYSTEM"
                },
                {
                    "events": [
                        {
                            "introduced": "14.0"
                        },
                        {
                            "fixed": "14.0_9"
                        }
                    ],
                    "type": "ECOSYSTEM"
                },
                {
                    "events": [
                        {
                            "introduced": "13.3"
                        },
                        {
                            "fixed": "13.3_5"
                        }
                    ],
                    "type": "ECOSYSTEM"
                }
            ]
        }
    ],
    "database_specific": {
        "discovery": "2024-08-07T00:00:00Z",
        "references": {
            "cvename": [
                "CVE-2024-6640"
            ],
            "freebsdsa": [
                "SA-24:05.pf"
            ]
        },
        "vid": "f140cff0-771a-11ef-9a62-002590c1f29c"
    },
    "details": "# Problem Description:\n\nIn ICMPv6 Neighbor Discovery (ND), the ID is always 0. When pf is\nconfigured to allow ND and block incoming Echo Requests, a crafted Echo\nRequest packet after a Neighbor Solicitation (NS) can trigger an Echo\nReply. The packet has to come from the same host as the NS and have a\nzero as identifier to match the state created by the Neighbor Discovery\nand allow replies to be generated.\n\n# Impact:\n\nICMPv6 packets with identifier value of zero bypass firewall rules\nwritten on the assumption that the incoming packets are going to create\na state in the state table.\n\n# Note:\n\nThis advisory introduced additional issues that were addressed by\nFreeBSD-EN-24:16.pf. Please refer to that erratum for additional fixes.\n",
    "id": "FreeBSD-2024-0234",
    "modified": "2024-09-20T00:00:00Z",
    "published": "2024-09-20T00:00:00Z",
    "references": [
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2024-6640"
        },
        {
            "type": "ADVISORY",
            "url": "https://www.freebsd.org/security/advisories/FreeBSD-SA-24:05.pf.asc"
        },
        {
            "type": "WEB",
            "url": "https://www.freebsd.org/security/advisories/FreeBSD-EN-24:16.pf.asc"
        }
    ],
    "schema_version": "1.7.0",
    "summary": "FreeBSD -- pf incorrectly matches different ICMPv6 states in the state table"
}
