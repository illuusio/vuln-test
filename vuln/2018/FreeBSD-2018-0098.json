{
    "affected": [
        {
            "package": {
                "ecosystem": "FreeBSD:ports",
                "name": "ruby"
            },
            "ranges": [
                {
                    "events": [
                        {
                            "introduced": "2.3.0,1"
                        },
                        {
                            "fixed": "2.3.7,1"
                        }
                    ],
                    "type": "ECOSYSTEM"
                },
                {
                    "events": [
                        {
                            "introduced": "2.4.0,1"
                        },
                        {
                            "fixed": "2.4.4,1"
                        }
                    ],
                    "type": "ECOSYSTEM"
                },
                {
                    "events": [
                        {
                            "introduced": "2.5.0,1"
                        },
                        {
                            "fixed": "2.5.1,1"
                        }
                    ],
                    "type": "ECOSYSTEM"
                }
            ]
        }
    ],
    "database_specific": {
        "cite": [
            "https://www.ruby-lang.org/en/news/2018/03/28/ruby-2-5-1-released/"
        ],
        "discovery": "2018-03-28T00:00:00Z",
        "references": {
            "cvename": [
                "CVE-2017-17742",
                "CVE-2018-6914",
                "CVE-2018-8777",
                "CVE-2018-8778",
                "CVE-2018-8779",
                "CVE-2018-8780"
            ]
        },
        "vid": "eb69bcf2-18ef-4aa2-bb0c-83b263364089"
    },
    "details": "Ruby news:\n\n> CVE-2017-17742: HTTP response splitting in WEBrick\n>\n> If a script accepts an external input and outputs it without\n> modification as a part of HTTP responses, an attacker can use newline\n> characters to deceive the clients that the HTTP response header is\n> stopped at there, and can inject fake HTTP responses after the newline\n> characters to show malicious contents to the clients.\n>\n> CVE-2018-6914: Unintentional file and directory creation with\n> directory traversal in tempfile and tmpdir\n>\n> Dir.mktmpdir method introduced by tmpdir library accepts the prefix\n> and the suffix of the directory which is created as the first\n> parameter. The prefix can contain relative directory specifiers\n> \\\"../\\\", so this method can be used to target any directory. So, if a\n> script accepts an external input as the prefix, and the targeted\n> directory has inappropriate permissions or the ruby process has\n> inappropriate privileges, the attacker can create a directory or a\n> file at any directory.\n>\n> CVE-2018-8777: DoS by large request in WEBrick\n>\n> If an attacker sends a large request which contains huge HTTP headers,\n> WEBrick try to process it on memory, so the request causes the\n> out-of-memory DoS attack.\n>\n> CVE-2018-8778: Buffer under-read in String#unpack\n>\n> String#unpack receives format specifiers as its parameter, and can be\n> specified the position of parsing the data by the specifier @. If a\n> big number is passed with @, the number is treated as the negative\n> value, and out-of-buffer read is occurred. So, if a script accepts an\n> external input as the argument of String#unpack, the attacker can read\n> data on heaps.\n>\n> CVE-2018-8779: Unintentional socket creation by poisoned NUL byte in\n> UNIXServer and UNIXSocket\n>\n> UNIXServer.open accepts the path of the socket to be created at the\n> first parameter. If the path contains NUL (\\\\0) bytes, this method\n> recognize that the path is completed before the NUL bytes. So, if a\n> script accepts an external input as the argument of this method, the\n> attacker can make the socket file in the unintentional path. And,\n> UNIXSocket.open also accepts the path of the socket to be created at\n> the first parameter without checking NUL bytes like UNIXServer.open.\n> So, if a script accepts an external input as the argument of this\n> method, the attacker can accepts the socket file in the unintentional\n> path.\n>\n> CVE-2018-8780: Unintentional directory traversal by poisoned NUL byte\n> in Dir\n>\n> Dir.open, Dir.new, Dir.entries and Dir.empty? accept the path of the\n> target directory as their parameter. If the parameter contains NUL\n> (\\\\0) bytes, these methods recognize that the path is completed before\n> the NUL bytes. So, if a script accepts an external input as the\n> argument of these methods, the attacker can make the unintentional\n> directory traversal.\n",
    "id": "FreeBSD-2018-0098",
    "modified": "2018-03-29T00:00:00Z",
    "published": "2018-03-29T00:00:00Z",
    "references": [
        {
            "type": "REPORT",
            "url": "https://www.ruby-lang.org/en/news/2018/03/28/ruby-2-5-1-released/"
        },
        {
            "type": "WEB",
            "url": "https://www.ruby-lang.org/en/news/2018/03/28/ruby-2-5-1-released/"
        },
        {
            "type": "WEB",
            "url": "https://www.ruby-lang.org/en/news/2018/03/28/ruby-2-4-4-released/"
        },
        {
            "type": "WEB",
            "url": "https://www.ruby-lang.org/en/news/2018/03/28/ruby-2-3-7-released/"
        },
        {
            "type": "WEB",
            "url": "https://www.ruby-lang.org/en/news/2018/03/28/http-response-splitting-in-webrick-cve-2017-17742/"
        },
        {
            "type": "WEB",
            "url": "https://www.ruby-lang.org/en/news/2018/03/28/unintentional-file-and-directory-creation-with-directory-traversal-cve-2018-6914/"
        },
        {
            "type": "WEB",
            "url": "https://www.ruby-lang.org/en/news/2018/03/28/large-request-dos-in-webrick-cve-2018-8777/"
        },
        {
            "type": "WEB",
            "url": "https://www.ruby-lang.org/en/news/2018/03/28/buffer-under-read-unpack-cve-2018-8778/"
        },
        {
            "type": "WEB",
            "url": "https://www.ruby-lang.org/en/news/2018/03/28/poisoned-nul-byte-unixsocket-cve-2018-8779/"
        },
        {
            "type": "WEB",
            "url": "https://www.ruby-lang.org/en/news/2018/03/28/poisoned-nul-byte-dir-cve-2018-8780/"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2017-17742"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2018-6914"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2018-8777"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2018-8778"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2018-8779"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2018-8780"
        }
    ],
    "schema_version": "1.7.0",
    "summary": "ruby -- multiple vulnerabilities"
}
