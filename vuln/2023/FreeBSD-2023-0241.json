{
    "affected": [
        {
            "package": {
                "ecosystem": "FreeBSD:ports",
                "name": "FreeBSD"
            },
            "ranges": [
                {
                    "events": [
                        {
                            "introduced": "13.1"
                        },
                        {
                            "fixed": "13.1_7"
                        }
                    ],
                    "type": "ECOSYSTEM"
                },
                {
                    "events": [
                        {
                            "introduced": "12.4"
                        },
                        {
                            "fixed": "12.4_2"
                        }
                    ],
                    "type": "ECOSYSTEM"
                },
                {
                    "events": [
                        {
                            "introduced": "12.3"
                        },
                        {
                            "fixed": "12.3_12"
                        }
                    ],
                    "type": "ECOSYSTEM"
                }
            ]
        }
    ],
    "database_specific": {
        "discovery": "2023-02-16T00:00:00Z",
        "references": {
            "cvename": [
                "CVE-2023-0286",
                "CVE-2023-0215",
                "CVE-2022-4450",
                "CVE-2022-4304"
            ],
            "freebsdsa": [
                "SA-23:03.openssl"
            ]
        },
        "vid": "c8eb4c40-47bd-11ee-8e38-002590c1f29c"
    },
    "details": "# Problem Description:\n\n## X.400 address type confusion in X.509 GeneralName (CVE-2023-0286)\n\nThere is a type confusion vulnerability relating to X.400 address\nprocessing inside an X.509 GeneralName. X.400 addresses were parsed as\nan ASN1_STRING but the public structure definition for GENERAL_NAME\nincorrectly specified the type of the x400Address field as ASN1_TYPE.\nThis field is subsequently interpreted by the OpenSSL function\nGENERAL_NAME_cmp as an ASN1_TYPE rather than an ASN1_STRING.\n\n## Timing Oracle in RSA Decryption (CVE-2022-4304)\n\nA timing based side channel exists in the OpenSSL RSA Decryption\nimplementation.\n\n## Use-after-free following BIO_new_NDEF (CVE-2023-0215)\n\nThe public API function BIO_new_NDEF is a helper function used for\nstreaming ASN.1 data via a BIO. It is primarily used internally to\nOpenSSL to support the SMIME, CMS and PKCS7 streaming capabilities, but\nmay also be called directly by end user applications.\n\nThe function receives a BIO from the caller, prepends a new BIO_f_asn1\nfilter BIO onto the front of it to form a BIO chain, and then returns\nthe new head of the BIO chain to the caller. Under certain conditions,\nfor example if a CMS recipient public key is invalid, the new filter BIO\nis freed and the function returns a NULL result indicating a failure.\nHowever, in this case, the BIO chain is not properly cleaned up and the\nBIO passed by the caller still retains internal pointers to the\npreviously freed filter BIO.\n\n## Double free after calling PEM_read_bio_ex (CVE-2022-4450)\n\nThe function PEM_read_bio_ex() reads a PEM file from a BIO and parses\nand decodes the \\\"name\\\" (e.g. \\\"CERTIFICATE\\\"), any header data and the\npayload data. If the function succeeds then the \\\"name_out\\\", \\\"header\\\"\nand \\\"data\\\" arguments are populated with pointers to buffers containing\nthe relevant decoded data. The caller is responsible for freeing those\nbuffers. It is possible to construct a PEM file that results in 0 bytes\nof payload data. In this case PEM_read_bio_ex() will return a failure\ncode but will populate the header argument with a pointer to a buffer\nthat has already been freed.\n\n# Impact:\n\n## X.400 address type confusion in X.509 GeneralName (CVE-2023-0286)\n\nWhen CRL checking is enabled (i.e. the application sets the\nX509_V_FLAG_CRL_CHECK flag), this vulnerability may allow an attacker to\npass arbitrary pointers to a memcmp call, enabling them to read memory\ncontents or enact a denial of service. In most cases, the attack\nrequires the attacker to provide both the certificate chain and CRL,\nneither of which need to have a valid signature. If the attacker only\ncontrols one of these inputs, the other input must already contain an\nX.400 address as a CRL distribution point, which is uncommon. As such,\nthis vulnerability is most likely to only affect applications which have\nimplemented their own functionality for retrieving CRLs over a network.\n\n## Timing Oracle in RSA Decryption (CVE-2022-4304)\n\nA timing based side channel exists in the OpenSSL RSA Decryption\nimplementation which could be sufficient to recover a plaintext across a\nnetwork in a Bleichenbacher style attack. To achieve a successful\ndecryption an attacker would have to be able to send a very large number\nof trial messages for decryption. The vulnerability affects all RSA\npadding modes: PKCS#1 v1.5, RSA-OEAP and RSASVE.\n\n## Use-after-free following BIO_new_NDEF (CVE-2023-0215)\n\nA use-after-free will occur under certain conditions. This will most\nlikely result in a crash.\n\n## Double free after calling PEM_read_bio_ex (CVE-2022-4450)\n\nA double free may occur. This will most likely lead to a crash. This\ncould be exploited by an attacker who has the ability to supply\nmalicious PEM files for parsing to achieve a denial of service attack.\n",
    "id": "FreeBSD-2023-0241",
    "modified": "2023-08-31T00:00:00Z",
    "published": "2023-08-31T00:00:00Z",
    "references": [
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2023-0286"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2023-0215"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2022-4450"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2022-4304"
        },
        {
            "type": "ADVISORY",
            "url": "https://www.freebsd.org/security/advisories/FreeBSD-SA-23:03.openssl.asc"
        }
    ],
    "schema_version": "1.7.0",
    "summary": "FreeBSD -- Multiple vulnerabilities in OpenSSL"
}
