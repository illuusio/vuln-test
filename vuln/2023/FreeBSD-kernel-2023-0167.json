{
    "affected": [
        {
            "package": {
                "ecosystem": "FreeBSD:ports",
                "name": "samba416"
            },
            "ranges": [
                {
                    "events": [
                        {
                            "fixed": "4.16.11"
                        },
                        {
                            "introduced": "0"
                        }
                    ],
                    "type": "ECOSYSTEM"
                }
            ]
        },
        {
            "package": {
                "ecosystem": "FreeBSD:ports",
                "name": "samba413"
            },
            "ranges": [
                {
                    "events": [
                        {
                            "fixed": "4.13.17_6"
                        },
                        {
                            "introduced": "0"
                        }
                    ],
                    "type": "ECOSYSTEM"
                }
            ]
        }
    ],
    "database_specific": {
        "discovery": "2023-07-19T00:00:00Z",
        "vid": "441e1e1a-27a5-11ee-a156-080027f5fec9"
    },
    "details": "The Samba Team reports:\n\n> CVE-2023-34967: Samba Spotlight mdssvc RPC Request Type Confusion DoS Vulnerability\n> :   When parsing Spotlight mdssvc RPC packets, one encoded\n>     data structure is a key-value style dictionary where\n>     keys are character strings and values can be any of\n>     the supported types in the mdssvc protocol. Due to a\n>     lack of type checking in callers of the function\n>     dalloc\\_value\\_for\\_key(), which returns the object\n>     associated with a key, a caller may trigger a crash in\n>     talloc\\_get\\_size() when talloc detects that the passed in\n>     pointer is not a valid talloc pointer. As RPC worker\n>     processes are shared among multiple client connections,\n>     a malicious client can crash the worker process\n>     affecting all other clients that are also served by this\n>     worker.\n>\n> CVE-2022-2127: Out-Of-Bounds read in winbind AUTH\\_CRAP\n> :   When doing NTLM authentication, the client sends replies\n>     to cryptographic challenges back to the server. These\n>     replies have variable length. Winbind did not properly\n>     bounds-check the lan manager response length, which\n>     despite the lan manager version no longer being used is\n>     still part of the protocol. If the system is running\n>     Samba's ntlm\\_auth as authentication backend for services\n>     like Squid (or a very unusual configuration with\n>     FreeRADIUS), the vulnarebility is remotely exploitable.\n>     If not so configured, or to exploit this vulnerability\n>     locally, the user must have access to the privileged\n>     winbindd UNIX domain socket (a subdirectory with name\n>     'winbindd\\_privileged' under \"state directory\", as set in\n>     the smb.conf). This access is normally only given so\n>     special system services like Squid or FreeRADIUS, use\n>     this feature.\n>\n> CVE-2023-34968: Spotlight server-side Share Path Disclosure\n> :   As part of the Spotlight protocol, the initial request\n>     returns a path associated with the sharename targeted by\n>     the RPC request. Samba returns the real server-side\n>     share path at this point, as well as returning the\n>     absolute server-side path of results in search queries\n>     by clients. Known server side paths could be used to\n>     mount subsequent more serious security attacks or could\n>     disclose confidential information that is part of the\n>     path. To mitigate the issue, Samba will replace the\n>     real server-side path with a fake path constructed from\n>     the sharename.\n>\n> CVE-2023-34966: Samba Spotlight mdssvc RPC Request Infinite Loop DoS Vulnerability\n> :   When parsing Spotlight mdssvc RPC packets sent by the\n>     client, the core unmarshalling function sl\\_unpack\\_loop()\n>     did not validate a field in the network packet that\n>     contains the count of elements in an array-like\n>     structure. By passing 0 as the count value, the attacked\n>     function will run in an endless loop consuming 100% CPU.\n>     This bug only affects servers where Spotlight is\n>     explicitly enabled globally or on individual shares with\n>     \"spotlight = yes\".\n>\n> CVE-2023-3347: SMB2 packet signing not enforced\n> :   SMB2 packet signing is not enforced if an admin\n>     configured \"server signing = required\" or for SMB2\n>     connections to Domain Controllers where SMB2 packet\n>     signing is mandatory. SMB2 packet signing is a\n>     mechanism that ensures the integrity and authenticity of\n>     data exchanged between a client and a server using the\n>     SMB2 protocol. It provides protection against certain\n>     types of attacks, such as man-in-the-middle attacks,\n>     where an attacker intercepts network traffic and\n>     modifies the SMB2 messages. Both client and server of\n>     an SMB2 connection can require that signing is being\n>     used. The server-side setting in Samba to configure\n>     signing to be required is \"server signing = required\".\n>     Note that on an Samba AD DCs this is also the default\n>     for all SMB2 connections. Unless the client requires\n>     signing which would result in signing being used on the\n>     SMB2 connection, sensitive data might have been modified\n>     by an attacker. Clients connecting to IPC$ on an AD DC\n>     will require signed connections being used, so the\n>     integrity of these connections was not affected.",
    "id": "FreeBSD-kernel-2023-0167",
    "modified": "2023-08-05T00:00:00Z",
    "published": "2023-08-05T00:00:00Z",
    "references": [
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2023-34967"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2022-2127"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2023-34968"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2023-34966"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2023-3347"
        },
        {
            "type": "WEB",
            "url": "https://www.samba.org/samba/security/CVE-2023-34967.html"
        },
        {
            "type": "WEB",
            "url": "https://www.samba.org/samba/security/CVE-2022-2127.html"
        },
        {
            "type": "WEB",
            "url": "https://www.samba.org/samba/security/CVE-2023-34968.html"
        },
        {
            "type": "WEB",
            "url": "https://www.samba.org/samba/security/CVE-2023-34966.html"
        },
        {
            "type": "WEB",
            "url": "https://www.samba.org/samba/security/CVE-2023-3347.html"
        }
    ],
    "schema_version": "1.7.0",
    "summary": "samba -- multiple vulnerabilities"
}
