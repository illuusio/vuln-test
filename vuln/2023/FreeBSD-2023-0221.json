{
    "affected": [
        {
            "package": {
                "ecosystem": "FreeBSD:ports",
                "name": "samba416"
            },
            "ranges": [
                {
                    "events": [
                        {
                            "fixed": "4.16.11"
                        },
                        {
                            "introduced": "0"
                        }
                    ],
                    "type": "ECOSYSTEM"
                }
            ]
        },
        {
            "package": {
                "ecosystem": "FreeBSD:ports",
                "name": "samba413"
            },
            "ranges": [
                {
                    "events": [
                        {
                            "fixed": "4.13.17_6"
                        },
                        {
                            "introduced": "0"
                        }
                    ],
                    "type": "ECOSYSTEM"
                }
            ]
        }
    ],
    "database_specific": {
        "cite": [
            "https://www.samba.org/samba/latest_news.html#4.18.5"
        ],
        "discovery": "2023-07-19T00:00:00Z",
        "references": {
            "cvename": [
                "CVE-2023-34967",
                "CVE-2022-2127",
                "CVE-2023-34968",
                "CVE-2023-34966",
                "CVE-2023-3347"
            ]
        },
        "vid": "441e1e1a-27a5-11ee-a156-080027f5fec9"
    },
    "details": "The Samba Team reports:\n\n> \n>\n> CVE-2023-34967: Samba Spotlight mdssvc RPC Request Type Confusion DoS Vulnerability\n> :   When parsing Spotlight mdssvc RPC packets, one encoded data\n>     structure is a key-value style dictionary where keys are character\n>     strings and values can be any of the supported types in the mdssvc\n>     protocol. Due to a lack of type checking in callers of the\n>     function dalloc_value_for_key(), which returns the object\n>     associated with a key, a caller may trigger a crash in\n>     talloc_get_size() when talloc detects that the passed in pointer\n>     is not a valid talloc pointer. As RPC worker processes are shared\n>     among multiple client connections, a malicious client can crash\n>     the worker process affecting all other clients that are also\n>     served by this worker.\n>\n> CVE-2022-2127: Out-Of-Bounds read in winbind AUTH_CRAP\n> :   When doing NTLM authentication, the client sends replies to\n>     cryptographic challenges back to the server. These replies have\n>     variable length. Winbind did not properly bounds-check the lan\n>     manager response length, which despite the lan manager version no\n>     longer being used is still part of the protocol. If the system is\n>     running Samba\\'s ntlm_auth as authentication backend for services\n>     like Squid (or a very unusual configuration with FreeRADIUS), the\n>     vulnarebility is remotely exploitable. If not so configured, or to\n>     exploit this vulnerability locally, the user must have access to\n>     the privileged winbindd UNIX domain socket (a subdirectory with\n>     name \\'winbindd_privileged\\' under \\\"state directory\\\", as set in\n>     the smb.conf). This access is normally only given so special\n>     system services like Squid or FreeRADIUS, use this feature.\n>\n> CVE-2023-34968: Spotlight server-side Share Path Disclosure\n> :   As part of the Spotlight protocol, the initial request returns a\n>     path associated with the sharename targeted by the RPC request.\n>     Samba returns the real server-side share path at this point, as\n>     well as returning the absolute server-side path of results in\n>     search queries by clients. Known server side paths could be used\n>     to mount subsequent more serious security attacks or could\n>     disclose confidential information that is part of the path. To\n>     mitigate the issue, Samba will replace the real server-side path\n>     with a fake path constructed from the sharename.\n>\n> CVE-2023-34966: Samba Spotlight mdssvc RPC Request Infinite Loop DoS Vulnerability\n> :   When parsing Spotlight mdssvc RPC packets sent by the client, the\n>     core unmarshalling function sl_unpack_loop() did not validate a\n>     field in the network packet that contains the count of elements in\n>     an array-like structure. By passing 0 as the count value, the\n>     attacked function will run in an endless loop consuming 100% CPU.\n>     This bug only affects servers where Spotlight is explicitly\n>     enabled globally or on individual shares with \\\"spotlight = yes\\\".\n>\n> CVE-2023-3347: SMB2 packet signing not enforced\n> :   SMB2 packet signing is not enforced if an admin configured\n>     \\\"server signing = required\\\" or for SMB2 connections to Domain\n>     Controllers where SMB2 packet signing is mandatory. SMB2 packet\n>     signing is a mechanism that ensures the integrity and authenticity\n>     of data exchanged between a client and a server using the SMB2\n>     protocol. It provides protection against certain types of attacks,\n>     such as man-in-the-middle attacks, where an attacker intercepts\n>     network traffic and modifies the SMB2 messages. Both client and\n>     server of an SMB2 connection can require that signing is being\n>     used. The server-side setting in Samba to configure signing to be\n>     required is \\\"server signing = required\\\". Note that on an Samba\n>     AD DCs this is also the default for all SMB2 connections. Unless\n>     the client requires signing which would result in signing being\n>     used on the SMB2 connection, sensitive data might have been\n>     modified by an attacker. Clients connecting to IPC\\$ on an AD DC\n>     will require signed connections being used, so the integrity of\n>     these connections was not affected.\n",
    "id": "FreeBSD-2023-0221",
    "modified": "2023-08-05T00:00:00Z",
    "published": "2023-08-05T00:00:00Z",
    "references": [
        {
            "type": "REPORT",
            "url": "https://www.samba.org/samba/latest_news.html#4.18.5"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2023-34967"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2022-2127"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2023-34968"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2023-34966"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2023-3347"
        },
        {
            "type": "WEB",
            "url": "https://www.samba.org/samba/security/CVE-2023-34967.html"
        },
        {
            "type": "WEB",
            "url": "https://www.samba.org/samba/security/CVE-2022-2127.html"
        },
        {
            "type": "WEB",
            "url": "https://www.samba.org/samba/security/CVE-2023-34968.html"
        },
        {
            "type": "WEB",
            "url": "https://www.samba.org/samba/security/CVE-2023-34966.html"
        },
        {
            "type": "WEB",
            "url": "https://www.samba.org/samba/security/CVE-2023-3347.html"
        }
    ],
    "schema_version": "1.7.0",
    "summary": "samba -- multiple vulnerabilities"
}
