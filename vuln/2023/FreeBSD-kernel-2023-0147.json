{
    "affected": [
        {
            "package": {
                "ecosystem": "FreeBSD:ports",
                "name": "FreeBSD"
            },
            "ranges": [
                {
                    "events": [
                        {
                            "introduced": "13.1"
                        },
                        {
                            "fixed": "13.1_7"
                        }
                    ],
                    "type": "ECOSYSTEM"
                },
                {
                    "events": [
                        {
                            "introduced": "12.4"
                        },
                        {
                            "fixed": "12.4_2"
                        }
                    ],
                    "type": "ECOSYSTEM"
                },
                {
                    "events": [
                        {
                            "introduced": "12.3"
                        },
                        {
                            "fixed": "12.3_12"
                        }
                    ],
                    "type": "ECOSYSTEM"
                }
            ]
        }
    ],
    "database_specific": {
        "discovery": "2023-02-16T00:00:00Z",
        "vid": "c8eb4c40-47bd-11ee-8e38-002590c1f29c"
    },
    "details": "Problem Description:\n====================\n\nX.400 address type confusion in X.509 GeneralName (CVE-2023-0286)\n-----------------------------------------------------------------\n\nThere is a type confusion vulnerability relating to X.400 address processing\ninside an X.509 GeneralName. X.400 addresses were parsed as an ASN1\\_STRING but\nthe public structure definition for GENERAL\\_NAME incorrectly specified the type\nof the x400Address field as ASN1\\_TYPE. This field is subsequently interpreted by\nthe OpenSSL function GENERAL\\_NAME\\_cmp as an ASN1\\_TYPE rather than an\nASN1\\_STRING.\n\nTiming Oracle in RSA Decryption (CVE-2022-4304)\n-----------------------------------------------\n\nA timing based side channel exists in the OpenSSL RSA Decryption\nimplementation.\n\nUse-after-free following BIO\\_new\\_NDEF (CVE-2023-0215)\n-------------------------------------------------------\n\nThe public API function BIO\\_new\\_NDEF is a helper function used for streaming\nASN.1 data via a BIO. It is primarily used internally to OpenSSL to support\nthe SMIME, CMS and PKCS7 streaming capabilities, but may also be called\ndirectly by end user applications.\n\nThe function receives a BIO from the caller, prepends a new BIO\\_f\\_asn1 filter\nBIO onto the front of it to form a BIO chain, and then returns the new head\nof the BIO chain to the caller. Under certain conditions, for example if a\nCMS recipient public key is invalid, the new filter BIO is freed and the\nfunction returns a NULL result indicating a failure. However, in this case,\nthe BIO chain is not properly cleaned up and the BIO passed by the caller\nstill retains internal pointers to the previously freed filter BIO.\n\nDouble free after calling PEM\\_read\\_bio\\_ex (CVE-2022-4450)\n------------------------------------------------------------\n\nThe function PEM\\_read\\_bio\\_ex() reads a PEM file from a BIO and parses and\ndecodes the \"name\" (e.g. \"CERTIFICATE\"), any header data and the payload\ndata. If the function succeeds then the \"name\\_out\", \"header\" and \"data\"\narguments are populated with pointers to buffers containing the relevant\ndecoded data. The caller is responsible for freeing those buffers. It is\npossible to construct a PEM file that results in 0 bytes of payload data. In\nthis case PEM\\_read\\_bio\\_ex() will return a failure code but will populate the\nheader argument with a pointer to a buffer that has already been freed.\n\nImpact:\n=======\n\nX.400 address type confusion in X.509 GeneralName (CVE-2023-0286)\n-----------------------------------------------------------------\n\nWhen CRL checking is enabled (i.e. the application sets the\nX509\\_V\\_FLAG\\_CRL\\_CHECK flag), this vulnerability may allow an attacker to pass\narbitrary pointers to a memcmp call, enabling them to read memory contents or\nenact a denial of service. In most cases, the attack requires the attacker to\nprovide both the certificate chain and CRL, neither of which need to have a\nvalid signature. If the attacker only controls one of these inputs, the other\ninput must already contain an X.400 address as a CRL distribution point, which\nis uncommon. As such, this vulnerability is most likely to only affect\napplications which have implemented their own functionality for retrieving CRLs\nover a network.\n\nTiming Oracle in RSA Decryption (CVE-2022-4304)\n-----------------------------------------------\n\nA timing based side channel exists in the OpenSSL RSA Decryption implementation\nwhich could be sufficient to recover a plaintext across a network in a\nBleichenbacher style attack. To achieve a successful decryption an attacker\nwould have to be able to send a very large number of trial messages for\ndecryption. The vulnerability affects all RSA padding modes: PKCS#1 v1.5,\nRSA-OEAP and RSASVE.\n\nUse-after-free following BIO\\_new\\_NDEF (CVE-2023-0215)\n-------------------------------------------------------\n\nA use-after-free will occur under certain conditions. This will most likely\nresult in a crash.\n\nDouble free after calling PEM\\_read\\_bio\\_ex (CVE-2022-4450)\n------------------------------------------------------------\n\nA double free may occur. This will most likely lead to a crash. This could be\nexploited by an attacker who has the ability to supply malicious PEM files\nfor parsing to achieve a denial of service attack.",
    "id": "FreeBSD-kernel-2023-0147",
    "modified": "2023-08-31T00:00:00Z",
    "published": "2023-08-31T00:00:00Z",
    "references": [
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2023-0286"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2023-0215"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2022-4450"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2022-4304"
        },
        {
            "type": "ADVISORY",
            "url": "https://www.freebsd.org/security/advisories/FreeBSD-SA-23:03.openssl.asc"
        }
    ],
    "schema_version": "1.7.0",
    "summary": "FreeBSD -- Multiple vulnerabilities in OpenSSL"
}
