{
    "affected": [
        {
            "package": {
                "ecosystem": "FreeBSD:ports",
                "name": "FreeBSD"
            },
            "ranges": [
                {
                    "events": [
                        {
                            "introduced": "13.1"
                        },
                        {
                            "fixed": "13.1_5"
                        }
                    ],
                    "type": "ECOSYSTEM"
                },
                {
                    "events": [
                        {
                            "introduced": "12.3"
                        },
                        {
                            "fixed": "12.3_10"
                        }
                    ],
                    "type": "ECOSYSTEM"
                }
            ]
        }
    ],
    "database_specific": {
        "discovery": "2022-11-29T00:00:00Z",
        "references": {
            "cvename": [
                "CVE-2022-23093"
            ],
            "freebsdsa": [
                "SA-22:15.ping"
            ]
        },
        "vid": "a005aea9-47bb-11ee-8e38-002590c1f29c"
    },
    "details": "# Problem Description:\n\nping reads raw IP packets from the network to process responses in the\npr_pack() function. As part of processing a response ping has to\nreconstruct the IP header, the ICMP header and if present a \\\"quoted\npacket,\\\" which represents the packet that generated an ICMP error. The\nquoted packet again has an IP header and an ICMP header.\n\nThe pr_pack() copies received IP and ICMP headers into stack buffers for\nfurther processing. In so doing, it fails to take into account the\npossible presence of IP option headers following the IP header in either\nthe response or the quoted packet. When IP options are present,\npr_pack() overflows the destination buffer by up to 40 bytes.\n\n# Impact:\n\nThe memory safety bugs described above can be triggered by a remote\nhost, causing the ping program to crash.\n\nThe ping process runs in a capability mode sandbox on all affected\nversions of FreeBSD and is thus very constrained in how it can interact\nwith the rest of the system at the point where the bug can occur.\n",
    "id": "FreeBSD-2023-0238",
    "modified": "2023-08-31T00:00:00Z",
    "published": "2023-08-31T00:00:00Z",
    "references": [
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2022-23093"
        },
        {
            "type": "ADVISORY",
            "url": "https://www.freebsd.org/security/advisories/FreeBSD-SA-22:15.ping.asc"
        }
    ],
    "schema_version": "1.7.0",
    "summary": "FreeBSD -- Stack overflow in ping(8)"
}
