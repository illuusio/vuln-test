{
    "affected": [
        {
            "package": {
                "ecosystem": "FreeBSD:ports",
                "name": "libXpm"
            },
            "ranges": [
                {
                    "events": [
                        {
                            "fixed": "3.5.15"
                        },
                        {
                            "introduced": "0"
                        }
                    ],
                    "type": "ECOSYSTEM"
                }
            ]
        }
    ],
    "database_specific": {
        "discovery": "2023-01-17T00:00:00Z",
        "vid": "38f213b6-8f3d-4067-91ef-bf14de7ba518"
    },
    "details": "The X.Org project reports:\n\n> 1. CVE-2022-46285: Infinite loop on unclosed comments\n>\n>    When reading XPM images from a file with libXpm 3.5.14 or older, if a\n>    comment in the file is not closed (i.e. a C-style comment starts with\n>    \"/\\*\" and is missing the closing \"\\*/\"), the ParseComment() function will\n>    loop forever calling getc() to try to read the rest of the comment,\n>    failing to notice that it has returned EOF, which may cause a denial of\n>    service to the calling program.\n>\n>    This issue was found by Marco Ivaldi of the Humanativa Group's HN Security team.\n>\n>    The fix is provided in\n>    https://gitlab.freedesktop.org/xorg/lib/libxpm/-/commit/a3a7c6dcc3b629d7650148\n> 2. CVE-2022-44617: Runaway loop on width of 0 and enormous height\n>\n>    When reading XPM images from a file with libXpm 3.5.14 or older, if a\n>    image has a width of 0 and a very large height, the ParsePixels() function\n>    will loop over the entire height calling getc() and ungetc() repeatedly,\n>    or in some circumstances, may loop seemingly forever, which may cause a denial\n>    of service to the calling program when given a small crafted XPM file to parse.\n>\n>    This issue was found by Martin Ettl.\n>\n>    The fix is provided in\n>    https://gitlab.freedesktop.org/xorg/lib/libxpm/-/commit/f80fa6ae47ad4a5beacb28\n>    and\n>    https://gitlab.freedesktop.org/xorg/lib/libxpm/-/commit/c5ab17bcc34914c0b0707d\n> 3. CVE-2022-4883: compression commands depend on $PATH\n>\n>    By default, on all platforms except MinGW, libXpm will detect if a filename\n>    ends in .Z or .gz, and will when reading such a file fork off an uncompress\n>    or gunzip command to read from via a pipe, and when writing such a file will\n>    fork off a compress or gzip command to write to via a pipe.\n>\n>    In libXpm 3.5.14 or older these are run via execlp(), relying on $PATH\n>    to find the commands. If libXpm is called from a program running with\n>    raised privileges, such as via setuid, then a malicious user could set\n>    $PATH to include programs of their choosing to be run with those privileges.\n>\n>    This issue was found by Alan Coopersmith of the Oracle Solaris team.",
    "id": "FreeBSD-kernel-2023-0306",
    "modified": "2023-03-23T00:00:00Z",
    "published": "2023-03-23T00:00:00Z",
    "references": [
        {
            "type": "WEB",
            "url": "https://lists.x.org/archives/xorg-announce/2023-January/003312.html"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2022-46285"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2022-44617"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2022-4883"
        }
    ],
    "schema_version": "1.7.0",
    "summary": "libXpm -- Issues handling XPM files"
}
