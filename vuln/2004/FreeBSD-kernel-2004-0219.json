{
    "affected": [
        {
            "package": {
                "ecosystem": "FreeBSD:ports",
                "name": "FreeBSD"
            },
            "ranges": [
                {
                    "events": [
                        {
                            "introduced": "5.2"
                        },
                        {
                            "fixed": "5.2_1"
                        }
                    ],
                    "type": "ECOSYSTEM"
                },
                {
                    "events": [
                        {
                            "introduced": "5.1"
                        },
                        {
                            "fixed": "5.1_12"
                        }
                    ],
                    "type": "ECOSYSTEM"
                }
            ]
        }
    ],
    "database_specific": {
        "discovery": "2004-01-30T00:00:00Z",
        "vid": "7229d900-88af-11d8-90d1-0020ed76ef5a"
    },
    "details": "The kernel interface for creating a snapshot of a\nfilesystem is the same as that for changing the flags on\nthat filesystem. Due to an oversight, the [mksnap\\_ffs(8)](http://www.freebsd.org/cgi/man.cgi?query=mksnap_ffs)\ncommand called that interface with only the snapshot flag\nset, causing all other flags to be reset to the default\nvalue.\n\nA regularly scheduled backup of a live filesystem, or\nany other process that uses the mksnap\\_ffs command\n(for instance, to provide a rough undelete functionality\non a file server), will clear any flags in effect on the\nfilesystem being snapshot. Possible consequences depend\non local usage, but can include disabling extended access\ncontrol lists or enabling the use of setuid executables\nstored on an untrusted filesystem.\n\nThe mksnap\\_ffs command is normally only available to\nthe superuser and members of the `operator' group. There\nis therefore no risk of a user gaining elevated privileges\ndirectly through use of the mksnap\\_ffs command unless\nit has been intentionally made available to unprivileged\nusers.",
    "id": "FreeBSD-kernel-2004-0219",
    "modified": "2004-05-05T00:00:00Z",
    "published": "2004-04-07T00:00:00Z",
    "references": [
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2004-0099"
        },
        {
            "type": "ADVISORY",
            "url": "https://www.freebsd.org/security/advisories/FreeBSD-SA-04:01.mksnap_ffs.asc"
        }
    ],
    "schema_version": "1.7.0",
    "summary": "mksnap_ffs clears file system options"
}
