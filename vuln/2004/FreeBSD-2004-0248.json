{
    "affected": [
        {
            "package": {
                "ecosystem": "FreeBSD:ports",
                "name": "cyrus-imapd"
            },
            "ranges": [
                {
                    "events": [
                        {
                            "fixed": "2.1.17"
                        },
                        {
                            "introduced": "0"
                        }
                    ],
                    "type": "ECOSYSTEM"
                },
                {
                    "events": [
                        {
                            "introduced": "2.2.*"
                        },
                        {
                            "last_affected": "2.2.6"
                        },
                        {
                            "fixed": "2.2.6"
                        }
                    ],
                    "type": "ECOSYSTEM"
                }
            ]
        }
    ],
    "database_specific": {
        "discovery": "2004-11-06T00:00:00Z",
        "references": {
            "cvename": [
                "CVE-2004-1012"
            ]
        },
        "vid": "114d70f3-3d16-11d9-8818-008088034841"
    },
    "details": "Due to a bug within the argument parser of the partial command an\nargument like \\\"body\\[p\\\" will be wrongly detected as \\\"body.peek\\\".\nBecause of this the bufferposition gets increased by 10 instead of 5 and\ncould therefore point outside the allocated memory buffer for the rest\nof the parsing process. In imapd versions prior to 2.2.7 the handling of\n\\\"body\\\" or \\\"bodypeek\\\" arguments was broken so that the terminating\n\\'\\]\\' got overwritten by a \\'\\\\0\\'. Combined the two problems allow a\npotential attacker to overwrite a single byte of malloc() control\nstructures, which leads to remote code execution if the attacker\nsuccessfully controls the heap layout.\n",
    "id": "FreeBSD-2004-0248",
    "modified": "2004-11-24T00:00:00Z",
    "published": "2004-11-22T00:00:00Z",
    "references": [
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2004-1012"
        },
        {
            "type": "WEB",
            "url": "http://security.e-matters.de/advisories/152004.html"
        }
    ],
    "schema_version": "1.7.0",
    "summary": "Cyrus IMAPd -- PARTIAL command out of bounds memory corruption"
}
