{
    "affected": [
        {
            "package": {
                "ecosystem": "FreeBSD:ports",
                "name": "tnftpd"
            },
            "ranges": [
                {
                    "events": [
                        {
                            "fixed": "20040810"
                        },
                        {
                            "introduced": "0"
                        }
                    ],
                    "type": "ECOSYSTEM"
                }
            ]
        },
        {
            "package": {
                "ecosystem": "FreeBSD:ports",
                "name": "lukemftpd"
            },
            "ranges": [
                {
                    "events": [
                        {
                            "introduced": "0"
                        }
                    ],
                    "type": "ECOSYSTEM"
                }
            ]
        },
        {
            "package": {
                "ecosystem": "FreeBSD:ports",
                "name": "FreeBSD"
            },
            "ranges": [
                {
                    "events": [
                        {
                            "last_affected": "4.7"
                        },
                        {
                            "fixed": "4.7"
                        },
                        {
                            "introduced": "0"
                        }
                    ],
                    "type": "ECOSYSTEM"
                }
            ]
        }
    ],
    "database_specific": {
        "discovery": "2004-08-17T00:00:00Z",
        "references": {
            "bid": [
                "10967"
            ],
            "cvename": [
                "CVE-2004-0794"
            ]
        },
        "vid": "c4b025bb-f05d-11d8-9837-000c41e2cdad"
    },
    "details": "lukemftpd(8) is an enhanced BSD FTP server produced within the NetBSD\nproject. The sources for lukemftpd are shipped with some versions of\nFreeBSD, however it is not built or installed by default. The build\nsystem option WANT_LUKEMFTPD must be set to build and install lukemftpd.\n\\[**NOTE**: An exception is FreeBSD 4.7-RELEASE, wherein lukemftpd was\ninstalled, but not enabled, by default.\\]\n\nPrzemyslaw Frasunek discovered several vulnerabilities in lukemftpd\narising from races in the out-of-band signal handling code used to\nimplement the ABOR command. As a result of these races, the internal\nstate of the FTP server may be manipulated in unexpected ways.\n\nA remote attacker may be able to cause FTP commands to be executed with\nthe privileges of the running lukemftpd process. This may be a\nlow-privilege \\`ftp\\' user if the \\`-r\\' command line option is\nspecified, or it may be superuser privileges if \\`-r\\' is \\*not\\*\nspecified.\n",
    "id": "FreeBSD-2004-0137",
    "modified": "2016-08-11T00:00:00Z",
    "published": "2004-08-17T00:00:00Z",
    "references": [
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2004-0794"
        },
        {
            "type": "ADVISORY",
            "url": "https://www.securityfocus.com/bid/10967/info"
        },
        {
            "type": "WEB",
            "url": "http://cvsweb.netbsd.org/bsdweb.cgi/src/libexec/ftpd/ftpd.c#rev1.158"
        },
        {
            "type": "WEB",
            "url": "ftp://ftp.netbsd.org/pub/NetBSD/security/advisories/NetBSD-SA2004-009.txt.asc"
        },
        {
            "type": "DISCUSSION",
            "url": "http://lists.netsys.com/pipermail/full-disclosure/2004-August/025418.html"
        }
    ],
    "schema_version": "1.7.0",
    "summary": "tnftpd -- remotely exploitable vulnerability"
}
