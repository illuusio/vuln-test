{
    "affected": [
        {
            "package": {
                "ecosystem": "FreeBSD:ports",
                "name": "seatd"
            },
            "ranges": [
                {
                    "events": [
                        {
                            "introduced": "0.6.0"
                        },
                        {
                            "fixed": "0.6.4"
                        }
                    ],
                    "type": "ECOSYSTEM"
                }
            ]
        }
    ],
    "database_specific": {
        "discovery": "2022-02-21T00:00:00Z",
        "vid": "1cd565da-455e-41b7-a5b9-86ad8e81e33e"
    },
    "details": "Kenny Levinsen reports:\n\n> seatd-launch could use a user-specified socket path instead of the\n> internally generated socket path, and would unlink the socket path\n> before use to guard against collision with leftover sockets. This\n> meant that a caller could freely control what file path would be\n> unlinked and replaced with a user-owned seatd socket for the duration\n> of the session.\n>\n> If seatd-launch had the SUID bit set, this could be used by a\n> malicious user to remove files with the privileges of the owner of\n> seatd-launch, which is likely root, and replace it with a user-owned\n> domain socket.\n>\n> This does not directly allow retrieving the contents of existing\n> files, and the user-owned socket file is at the current time not\n> believed to be directly useful for further exploitation.",
    "id": "FreeBSD-kernel-2022-0214",
    "modified": "2022-02-22T00:00:00Z",
    "published": "2022-02-21T00:00:00Z",
    "references": [
        {
            "type": "WEB",
            "url": "https://lists.sr.ht/~kennylevinsen/seatd-announce/%3CETEO7R.QG8B1KGD531R1%40kl.wtf%3E"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2022-25643"
        }
    ],
    "schema_version": "1.7.0",
    "summary": "seatd-launch -- remove files with escalated privileges with SUID"
}
