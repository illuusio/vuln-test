{
    "affected": [
        {
            "package": {
                "ecosystem": "FreeBSD:ports",
                "name": "wpa_supplicant"
            },
            "ranges": [
                {
                    "events": [
                        {
                            "fixed": "2.4_1"
                        },
                        {
                            "introduced": "0"
                        }
                    ],
                    "type": "ECOSYSTEM"
                }
            ]
        }
    ],
    "database_specific": {
        "cite": [
            "http://w1.fi/security/2015-1/wpa_supplicant-p2p-ssid-overflow.txt"
        ],
        "discovery": "2015-04-22T00:00:00Z",
        "references": {
            "cvename": [
                "CVE-2015-1863"
            ]
        },
        "vid": "cb9d2fcd-eb47-11e4-b03e-002590263bf5"
    },
    "details": "Jouni Malinen reports:\n\n> A vulnerability was found in how wpa_supplicant uses SSID information\n> parsed from management frames that create or update P2P peer entries\n> (e.g., Probe Response frame or number of P2P Public Action frames).\n> SSID field has valid length range of 0-32 octets. However, it is\n> transmitted in an element that has a 8-bit length field and potential\n> maximum payload length of 255 octets. wpa_supplicant was not\n> sufficiently verifying the payload length on one of the code paths\n> using the SSID received from a peer device.\n>\n> This can result in copying arbitrary data from an attacker to a fixed\n> length buffer of 32 bytes (i.e., a possible overflow of up to 223\n> bytes). The SSID buffer is within struct p2p_device that is allocated\n> from heap. The overflow can override couple of variables in the\n> struct, including a pointer that gets freed. In addition about 150\n> bytes (the exact length depending on architecture) can be written\n> beyond the end of the heap allocation.\n>\n> This could result in corrupted state in heap, unexpected program\n> behavior due to corrupted P2P peer device information, denial of\n> service due to wpa_supplicant process crash, exposure of memory\n> contents during GO Negotiation, and potentially arbitrary code\n> execution.\n>\n> Vulnerable versions/configurations\n>\n> wpa_supplicant v1.0-v2.4 with CONFIG_P2P build option enabled (which\n> is not compiled by default).\n>\n> Attacker (or a system controlled by the attacker) needs to be within\n> radio range of the vulnerable system to send a suitably constructed\n> management frame that triggers a P2P peer device information to be\n> created or updated.\n>\n> The vulnerability is easiest to exploit while the device has started\n> an active P2P operation (e.g., has ongoing P2P_FIND or P2P_LISTEN\n> control interface command in progress). However, it may be possible,\n> though significantly more difficult, to trigger this even without any\n> active P2P operation in progress.\n",
    "id": "FreeBSD-2015-0079",
    "modified": "2015-04-25T00:00:00Z",
    "published": "2015-04-25T00:00:00Z",
    "references": [
        {
            "type": "REPORT",
            "url": "http://w1.fi/security/2015-1/wpa_supplicant-p2p-ssid-overflow.txt"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2015-1863"
        },
        {
            "type": "WEB",
            "url": "http://w1.fi/security/2015-1/wpa_supplicant-p2p-ssid-overflow.txt"
        }
    ],
    "schema_version": "1.7.0",
    "summary": "wpa_supplicant -- P2P SSID processing vulnerability"
}
