{
    "affected": [
        {
            "package": {
                "ecosystem": "FreeBSD:ports",
                "name": "FreeBSD"
            },
            "ranges": [
                {
                    "events": [
                        {
                            "introduced": "11.4"
                        },
                        {
                            "fixed": "11.4_1"
                        }
                    ],
                    "type": "ECOSYSTEM"
                }
            ]
        }
    ],
    "database_specific": {
        "discovery": "2020-07-09T00:00:00Z",
        "vid": "f8b46415-c264-11ea-8659-901b0ef719ab"
    },
    "details": "Problem Description:\n====================\n\nposix\\_spawnp spawns a new thread with a limited stack allocated on the heap\nbefore delegating to execvp for the final execution within that thread.\n\nexecvp would previously make unbounded allocations on the stack, directly\nproportional to the length of the user-controlled PATH environment variable.\n\nImpact:\n=======\n\nLong values in the user-controlled PATH environment variable cause\nposix\\_spawnp to write beyond the end of stack that was allocated, ultimately\noverflowing the heap-allocated stack with a direct copy of the value stored\nin PATH.",
    "id": "FreeBSD-kernel-2020-0159",
    "modified": "2020-07-10T00:00:00Z",
    "published": "2020-07-10T00:00:00Z",
    "references": [
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2020-7458"
        },
        {
            "type": "ADVISORY",
            "url": "https://www.freebsd.org/security/advisories/FreeBSD-SA-20:18.posix_spawnp.asc"
        }
    ],
    "schema_version": "1.7.0",
    "summary": "FreeBSD -- posix_spawnp(3) buffer overflow"
}
