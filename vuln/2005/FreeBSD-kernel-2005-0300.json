{
    "affected": [
        {
            "package": {
                "ecosystem": "FreeBSD:ports",
                "name": "cups-lpr"
            },
            "ranges": [
                {
                    "events": [
                        {
                            "fixed": "1.1.23"
                        },
                        {
                            "introduced": "0"
                        }
                    ],
                    "type": "ECOSYSTEM"
                }
            ]
        },
        {
            "package": {
                "ecosystem": "FreeBSD:ports",
                "name": "fr-cups-lpr"
            },
            "ranges": [
                {
                    "events": [
                        {
                            "fixed": "1.1.23"
                        },
                        {
                            "introduced": "0"
                        }
                    ],
                    "type": "ECOSYSTEM"
                }
            ]
        }
    ],
    "database_specific": {
        "discovery": "2004-12-11T00:00:00Z",
        "vid": "7850a238-680a-11d9-a9e7-0001020eed82"
    },
    "details": "D. J. Bernstein reports that Bartlomiej Sieka has\ndiscovered several security vulnerabilities in lppasswd,\nwhich is part of CUPS. In the following excerpt from\nBernstein's email, CVE names have been added for each issue:\n\n> First, lppasswd blithely ignores write errors in\n> fputs(line,outfile) at lines 311 and 315 of lppasswd.c,\n> and in fprintf(...) at line 346. An attacker who fills up\n> the disk at the right moment can arrange for\n> /usr/local/etc/cups/passwd to be truncated.\n> *(CAN-2004-1268)*\n>\n> Second, if lppasswd bumps into a file-size resource limit\n> while writing passwd.new, it leaves passwd.new in place,\n> disabling all subsequent invocations of lppasswd. Any\n> local user can thus disable lppasswd...\n> *(CAN-2004-1269)*\n>\n> Third, line 306 of lppasswd.c prints an error message to\n> stderr but does not exit. This is not a problem on systems\n> that ensure that file descriptors 0, 1, and 2 are open for\n> setuid programs, but it is a problem on other systems;\n> lppasswd does not check that passwd.new is different from\n> stderr, so it ends up writing a user-controlled error\n> message to passwd if the user closes file descriptor\n> 2. *(CAN-2004-1270)*\n\n**Note:** The third issue, CVE-2004-1270, does\nnot affect FreeBSD 4.6-RELEASE or later systems, as these\nsystems ensure that the file descriptors 0, 1, and 2 are\nalways open for set-user-ID and set-group-ID programs.",
    "id": "FreeBSD-kernel-2005-0300",
    "modified": "2005-01-17T00:00:00Z",
    "published": "2005-01-17T00:00:00Z",
    "references": [
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2004-1268"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2004-1269"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2004-1270"
        },
        {
            "type": "ADVISORY",
            "url": "https://www.securityfocus.com/bid/12007/info"
        },
        {
            "type": "ADVISORY",
            "url": "https://www.securityfocus.com/bid/12004/info"
        },
        {
            "type": "WEB",
            "url": "http://www.cups.org/str.php?L1023"
        },
        {
            "type": "WEB",
            "url": "http://tigger.uic.edu/~jlongs2/holes/cups2.txt"
        }
    ],
    "schema_version": "1.7.0",
    "summary": "cups-lpr -- lppasswd multiple vulnerabilities"
}
