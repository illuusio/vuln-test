{
    "affected": [
        {
            "package": {
                "ecosystem": "FreeBSD:kernel",
                "name": "FreeBSD-kernel"
            },
            "ranges": [
                {
                    "events": [
                        {
                            "introduced": "12.0"
                        },
                        {
                            "fixed": "12.0_3"
                        }
                    ],
                    "type": "ECOSYSTEM"
                }
            ]
        }
    ],
    "database_specific": {
        "discovery": "2019-02-05T00:00:00Z",
        "vid": "86c89abf-2d91-11e9-bf3e-a4badb2f4699"
    },
    "details": "Problem Description:\n====================\n\nFreeBSD 12.0 attempts to handle the case where the\nreceiving process does not provide a sufficiently large\nbuffer for an incoming control message containing rights.\nIn particular, to avoid leaking the corresponding descriptors\ninto the receiving process' descriptor table, the kernel\nhandles the truncation case by closing descriptors referenced\nby the discarded message.\n\nThe code which performs this operation failed to release\na reference obtained on the file corresponding to a received\nright. This bug can be used to cause the reference counter\nto wrap around and free the file structure.\n\nImpact:\n=======\n\nA local user can exploit the bug to gain root privileges\nor escape from a jail.",
    "id": "FreeBSD-kernel-2019-0256",
    "modified": "2019-02-11T00:00:00Z",
    "published": "2019-02-11T00:00:00Z",
    "references": [
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2019-5596"
        },
        {
            "type": "ADVISORY",
            "url": "https://www.freebsd.org/security/advisories/FreeBSD-SA-19:02.fd.asc"
        }
    ],
    "schema_version": "1.7.0",
    "summary": "FreeBSD -- File description reference count leak"
}
