{
    "affected": [
        {
            "package": {
                "ecosystem": "FreeBSD:ports",
                "name": "typo3-8"
            },
            "ranges": [
                {
                    "events": [
                        {
                            "fixed": "8.7.30"
                        },
                        {
                            "introduced": "0"
                        }
                    ],
                    "type": "ECOSYSTEM"
                }
            ]
        },
        {
            "package": {
                "ecosystem": "FreeBSD:ports",
                "name": "typo3-9"
            },
            "ranges": [
                {
                    "events": [
                        {
                            "fixed": "9.5.13"
                        },
                        {
                            "introduced": "0"
                        }
                    ],
                    "type": "ECOSYSTEM"
                }
            ]
        }
    ],
    "database_specific": {
        "discovery": "2019-12-17T00:00:00Z",
        "vid": "1c9178aa-2709-11ea-9673-4c72b94353b5"
    },
    "details": "Typo3 core team reports:\n\n> It has been discovered that the output of field validation errors in the Form Framework is vulnerable\n> to cross-site scripting.\n>\n> It has been discovered that t3:// URL handling and typolink functionality are vulnerable to cross-site\n> scripting. Not only regular backend forms are affected but also frontend extensions which use the rendering\n> with typolink.\n>\n> It has been discovered that the output table listing in the Files backend module is vulnerable to cross-site\n> scripting when a file extension contains malicious sequences. Access to the file system of the server - either\n> directly or through synchronization - is required to exploit the vulnerability.\n>\n> It has been discovered that the extraction of manually uploaded ZIP archives in Extension Manager is vulnerable\n> to directory traversal. Admin privileges are required in order to exploit this vulnerability. Since TYPO3 v9 LTS,\n> System Maintainer privileges are required as well.\n>\n> Failing to properly escape user submitted content, class QueryGenerator is vulnerable to SQL injection.\n> Having system extension ext:lowlevel installed and a valid backend user having administrator privileges are\n> required to exploit this vulnerability.\n>\n> It has been discovered that classes QueryGenerator and QueryView are vulnerable to insecure deserialization.\n> Requirements for successfully exploiting this vulnerability (one of the following):\n> - having system extension ext:lowlevel (Backend Module: DB Check) installed and valid backend user having\n> administrator privileges\n> - having system extension ext:sys\\_action installed and valid backend user having limited privileges\n>\n> TYPO3 allows to upload files either in the backend user interface as well as in custom developed extensions.\n> To reduce the possibility to upload potential malicious code TYPO3 uses the fileDenyPattern to deny e.g. user\n> submitted PHP scripts from being persisted. Besides that it is possible for any editor to upload file assets\n> using the file module (fileadmin) or changing their avatar image shown in the TYPO3 backend.\n> Per default TYPO3 allows to upload and store HTML and SVG files as well using the mentioned functionalities.\n> Custom extension implementations probably would also accept those files when only the fileDenyPattern is evaluated.\n> Since HTML and SVG files - which might contain executable JavaScript code per W3C standard - could be directly\n> displayed in web clients, the whole web application is exposed to be vulnerable concerning Cross-Site Scripting.\n> Currently the following scenarios are known - given an authenticated regular editor is able to upload files using\n> the TYPO3 backend:\n> - directly target a potential victim to a known public resource in a URL, e.g. /fileadmin/malicious.svg or\n> /fileadmin/malicious.html\n> - using the TypoScript content object \u201cSVG\u201d (implemented in class ScalableVectorGraphicsContentObject)\n> having renderMode set to inline for SVG files (available since TYPO3 v9.0)\n> - custom implementations that directly output and render markup of HTML and SVG files\n> SVG files that are embedded using an img src=\u201dmalicious.svg\u201d tag are not vulnerable since potential\n> scripts are not executed in these scenarios (see https://www.w3.org/wiki/SVG\\_Security). The icon API of TYPO3\n> is not scope of this announcement since SVG icons need to be registered using an individual implementation,\n> which is not considered as user submitted content.\n>\n> It has been discovered that request handling in Extbase can be vulnerable to insecure deserialization.\n> User submitted payload has to be signed with a corresponding HMAC-SHA1 using the sensitive TYPO3 encryptionKey\n> as secret - invalid or unsigned payload is not deserialized.\n> However, since sensitive information could have been leaked by accident (e.g. in repositories or in commonly\n> known and unprotected backup files), there is the possibility that attackers know the private encryptionKey\n> and are able to calculate the required HMAC-SHA1 to allow a malicious payload to be deserialized.\n> Requirements for successfully exploiting this vulnerability (all of the following):\n> - rendering at least one Extbase plugin in the frontend\n> - encryptionKey has been leaked (from LocalConfiguration.php or corresponding .env file).",
    "id": "FreeBSD-kernel-2019-0005",
    "modified": "2019-12-25T00:00:00Z",
    "published": "2019-12-25T00:00:00Z",
    "references": [
        {
            "type": "WEB",
            "url": "https://typo3.org/security/advisory/typo3-core-sa-2019-021/"
        },
        {
            "type": "WEB",
            "url": "https://typo3.org/security/advisory/typo3-core-sa-2019-022/"
        },
        {
            "type": "WEB",
            "url": "https://typo3.org/security/advisory/typo3-core-sa-2019-023/"
        },
        {
            "type": "WEB",
            "url": "https://typo3.org/security/advisory/typo3-core-sa-2019-024/"
        },
        {
            "type": "WEB",
            "url": "https://typo3.org/security/advisory/typo3-core-sa-2019-025/"
        },
        {
            "type": "WEB",
            "url": "https://typo3.org/security/advisory/typo3-core-sa-2019-026/"
        },
        {
            "type": "WEB",
            "url": "https://typo3.org/security/advisory/typo3-psa-2019-010/"
        },
        {
            "type": "WEB",
            "url": "https://typo3.org/security/advisory/typo3-psa-2019-011/"
        }
    ],
    "schema_version": "1.7.0",
    "summary": "typo3 -- multiple vulnerabilities"
}
