{
    "affected": [
        {
            "package": {
                "ecosystem": "FreeBSD:ports",
                "name": "cups"
            },
            "ranges": [
                {
                    "events": [
                        {
                            "fixed": "2.4.11"
                        },
                        {
                            "introduced": "0"
                        }
                    ],
                    "type": "ECOSYSTEM"
                }
            ]
        }
    ],
    "database_specific": {
        "discovery": "2024-09-26T00:00:00Z",
        "vid": "24375796-7cbc-11ef-a3a9-001cc0382b2f"
    },
    "details": "OpenPrinting reports:\n\n> Due to the service binding to \\*:631 ( INADDR\\_ANY ), multiple bugs\n> in cups-browsed can be exploited in sequence to introduce a\n> malicious printer to the system. This chain of exploits ultimately\n> enables an attacker to execute arbitrary commands remotely on the\n> target machine without authentication when a print job is started.\n> Posing a significant security risk over the network. Notably, this\n> vulnerability is particularly concerning as it can be exploited\n> from the public internet, potentially exposing a vast number of\n> systems to remote attacks if their CUPS services are enabled.\n\nThe vulnerability allows an attacker on the internet to create a\nnew printer device with arbitrary commands in the PPD file of the\nprinter. Attacks using mDNS on the local network can also replace an\nexisting printer. The commands are executed when a user attempts to\nprint on the malicious device. They run with the privileges of the\nuser \"cups\".\n\nIt is recommended to disable the cups\\_browsed service until patches\nbecome available. On FreeBSD this is the default. You can check the\nstatus and disable the service with the following commands:\n\n`# service cups_browsed status  \n# service cups_browsed stop  \n# service cups_browsed disable`\n\nIf you choose to leave the service enabled, attacks from the\ninternet can be blocked by removing the \"cups\" protocol from the\nBrowseRemoteProtocols and BrowseProtocols directives in\n/usr/local/etc/cups/cups-browsed.conf. Attacks using mDNS can be\nblocked by removing the \"dnssd\" protocol as well. Access can be\nlimited to specific IP addresses using BrowseAllow, BrowseDeny, and\nBrowseOrder directives as documented in cups-browsed.conf(5). Then\nrestart the service with the following command:\n\n`# service cups_browsed restart`",
    "id": "FBSD-2024-09-27-01",
    "modified": "2024-10-02T00:00:00Z",
    "published": "2024-09-27T00:00:00Z",
    "references": [
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2024-47076"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2024-47175"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2024-47176"
        },
        {
            "type": "WEB",
            "url": "https://github.com/OpenPrinting/cups-browsed/security/advisories/GHSA-rj88-6mr5-rcw8"
        }
    ],
    "schema_version": "1.7.0",
    "summary": "cups-filters -- remote code execution"
}
