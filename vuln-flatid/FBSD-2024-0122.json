{
    "affected": [],
    "database_specific": {
        "discovery": "2024-09-04T00:00:00Z",
        "vid": "9bd5e47b-6b50-11ef-9a62-002590c1f29c"
    },
    "details": "Problem Description:\n====================\n\nSeveral vulnerabilities were found in the ctl subsystem.\n\nThe function ctl\\_write\\_buffer incorrectly set a flag which resulted\nin a kernel Use-After-Free when a command finished processing\n(CVE-2024-45063). The ctl\\_write\\_buffer and ctl\\_read\\_buffer functions\nallocated memory to be returned to userspace, without initializing\nit (CVE-2024-8178). The ctl\\_report\\_supported\\_opcodes function did\nnot sufficiently validate a field provided by userspace, allowing\nan arbitrary write to a limited amount of kernel help memory\n(CVE-2024-42416). The ctl\\_request\\_sense function could expose up\nto three bytes of the kernel heap to userspace (CVE-2024-43110).\n\nGuest virtual machines in the bhyve hypervisor can send SCSI commands\nto the corresponding kernel driver via the virtio\\_scsi interface.\nThis provides guests with direct access to the vulnerabilities\ncovered by this advisory.\n\nThe CAM Target Layer iSCSI target daemon ctld(8) accepts incoming\niSCSI connections, performs authentication and passes connections\nto the kernel ctl(4) target layer.\n\nImpact:\n=======\n\nMalicious software running in a guest VM that exposes virtio\\_scsi\ncan exploit the vulnerabilities to achieve code execution on the\nhost in the bhyve userspace process, which typically runs as root.\nNote that bhyve runs in a Capsicum sandbox, so malicious code is\nconstrained by the capabilities available to the bhyve process.\n\nA malicious iSCSI initiator could achieve remote code execution on\nthe iSCSI target host.",
    "id": "FBSD-2024-0122",
    "modified": "2024-09-05T00:00:00Z",
    "published": "2024-09-05T00:00:00Z",
    "references": [
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2024-8178"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2024-42416"
        },
        {
            "type": "ADVISORY",
            "url": "https://api.osv.dev/v1/vulns/CVE-2024-43110"
        },
        {
            "type": "ADVISORY",
            "url": "https://www.freebsd.org/security/advisories/FreeBSD-SA-24:11.ctl.asc"
        }
    ],
    "schema_version": "1.7.0",
    "summary": "FreeBSD -- Multiple issues in ctl(4) CAM Target Layer"
}
