schema_version: 1.7.0
modified: '2025-04-19T00:00:00Z'
published: '2025-04-19T00:00:00Z'
summary: 'ejabberd -- mod_muc_occupantid: Fix handling multiple occupant-id'
details: |-
  ejabberd team reports:

  > Fixed issue with handling of user provided occupant-id in
  > messages and presences sent to muc room. Server was
  > replacing just first instance of occupant-id with its own
  > version, leaving other ones untouched. That would mean that
  > depending on order in which clients send occupant-id, they
  > could see value provided by sender, and that could be used
  > to spoof as different sender.
references:
- type: WEB
  url: https://www.process-one.net/blog/ejabberd-25-04/#occupantid
affected: []
database_specific:
  vid: 1b8d502e-1cfd-11f0-944d-901b0e9408dc
  discovery: '2025-04-16T00:00:00Z'
id: FBSD-2025-0154
