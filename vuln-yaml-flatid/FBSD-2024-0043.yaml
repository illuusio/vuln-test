schema_version: 1.7.0
modified: '2024-11-14T00:00:00Z'
published: '2024-11-14T00:00:00Z'
summary: PostgreSQL -- PostgreSQL row security below e.g. subqueries disregards 
  user ID changes
details: |-
  PostgreSQL project reports:

  > Incomplete tracking in PostgreSQL of tables with row
  > security allows a reused query to view or change
  > different rows from those intended. CVE-2023-2455 and
  > CVE-2016-2193 fixed most interaction between row
  > security and user ID changes. They missed cases where a
  > subquery, WITH query, security invoker view, or
  > SQL-language function references a table with a
  > row-level security policy. This has the same
  > consequences as the two earlier CVEs. That is to say, it
  > leads to potentially incorrect policies being applied in
  > cases where role-specific policies are used and a given
  > query is planned under one role and then executed under
  > other roles. This scenario can happen under security
  > definer functions or when a common user and query is
  > planned initially and then re-used across multiple SET
  > ROLEs.
  > Applying an incorrect policy may permit a user to complete
  > otherwise-forbidden reads and modifications. This affects only databases
  > that have used CREATE POLICY to define a row security policy. An
  > attacker must tailor an attack to a particular application's pattern of
  > query plan reuse, user ID changes, and role-specific row security
  > policies.
references:
- type: ADVISORY
  url: https://api.osv.dev/v1/vulns/CVE-2024-10976
- type: WEB
  url: https://www.postgresql.org/support/security/CVE-2024-10976/
affected:
- package:
    ecosystem: FreeBSD:ports
    name: postgresql16-server
  ranges:
  - type: ECOSYSTEM
    events:
    - fixed: '16.5'
    - introduced: '0'
- package:
    ecosystem: FreeBSD:ports
    name: postgresql15-server
  ranges:
  - type: ECOSYSTEM
    events:
    - fixed: '15.9'
    - introduced: '0'
- package:
    ecosystem: FreeBSD:ports
    name: postgresql14-server
  ranges:
  - type: ECOSYSTEM
    events:
    - fixed: '14.14'
    - introduced: '0'
- package:
    ecosystem: FreeBSD:ports
    name: postgresql13-server
  ranges:
  - type: ECOSYSTEM
    events:
    - fixed: '13.17'
    - introduced: '0'
- package:
    ecosystem: FreeBSD:ports
    name: postgresql12-server
  ranges:
  - type: ECOSYSTEM
    events:
    - fixed: '12.21'
    - introduced: '0'
database_specific:
  vid: 3831292b-a29d-11ef-af48-6cc21735f730
  discovery: '2024-11-14T00:00:00Z'
id: FBSD-2024-0043
