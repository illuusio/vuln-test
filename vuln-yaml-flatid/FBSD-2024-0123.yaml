schema_version: 1.7.0
modified: '2024-09-05T00:00:00Z'
published: '2024-09-05T00:00:00Z'
summary: FreeBSD -- bhyve(8) privileged guest escape via TPM device passthrough
details: |-
  Problem Description:
  ====================

  bhyve can be configured to provide access to the host's TPM
  device, where it passes the communication through an emulated device
  provided to the guest. This may be performed on the command-line
  by starting bhyve with the `-l tpm,passthru,/dev/tpmX` parameters.

  The MMIO handler for the emulated device did not validate the offset
  and size of the memory access correctly, allowing guests to read
  and write memory contents outside of the memory area effectively
  allocated.

  Impact:
  =======

  Malicious software running in a guest VM can exploit the buffer
  overflow to achieve code execution on the host in the bhyve userspace
  process, which typically runs as root. Note that bhyve runs in a
  Capsicum sandbox, so malicious code is constrained by the capabilities
  available to the bhyve process.
references:
- type: ADVISORY
  url: https://api.osv.dev/v1/vulns/CVE-2024-41928
- type: ADVISORY
  url: https://www.freebsd.org/security/advisories/FreeBSD-SA-24:10.bhyve.asc
affected: []
database_specific:
  vid: 56d76414-6b50-11ef-9a62-002590c1f29c
  discovery: '2024-09-04T00:00:00Z'
id: FBSD-2024-0123
