schema_version: 1.7.0
modified: '2024-09-20T00:00:00Z'
published: '2024-09-20T00:00:00Z'
summary: FreeBSD -- pf incorrectly matches different ICMPv6 states in the state 
  table
details: |-
  Problem Description:
  ====================

  In ICMPv6 Neighbor Discovery (ND), the ID is always 0. When
  pf is configured to allow ND and block incoming Echo Requests, a
  crafted Echo Request packet after a Neighbor Solicitation (NS) can
  trigger an Echo Reply. The packet has to come from the same host
  as the NS and have a zero as identifier to match the state created
  by the Neighbor Discovery and allow replies to be generated.

  Impact:
  =======

  ICMPv6 packets with identifier value of zero bypass firewall
  rules written on the assumption that the incoming packets are going
  to create a state in the state table.

  Note:
  =====

  This advisory introduced additional issues that were addressed by
  FreeBSD-EN-24:16.pf. Please refer to that erratum for additional
  fixes.
references:
- type: ADVISORY
  url: https://api.osv.dev/v1/vulns/CVE-2024-6640
- type: ADVISORY
  url: https://www.freebsd.org/security/advisories/FreeBSD-SA-24:05.pf.asc
- type: WEB
  url: https://www.freebsd.org/security/advisories/FreeBSD-EN-24:16.pf.asc
affected: []
database_specific:
  vid: f140cff0-771a-11ef-9a62-002590c1f29c
  discovery: '2024-08-07T00:00:00Z'
id: FBSD-2024-0100
