schema_version: 1.7.0
modified: '2024-09-20T00:00:00Z'
published: '2024-09-20T00:00:00Z'
summary: FreeBSD -- Integer overflow in libnv
details: |-
  Problem Description:
  ====================

  A malicious value of size in a structure of packed libnv can
  cause an integer overflow, leading to the allocation of a smaller
  buffer than required for the parsed data. The introduced check was
  incorrect, as it took into account the size of the pointer, not the
  structure. This vulnerability affects both kernel and userland.

  This issue was originally intended to be addressed as part of
  FreeBSD-SA-24:09.libnv, but due to a logic issue, this issue was
  not properly addressed.

  Impact:
  =======

  It is possible for an attacker to overwrite portions of memory
  (in userland or the kernel) as the allocated buffer might be smaller
  than the data received from a malicious process. This vulnerability
  could result in privilege escalation or cause a system panic.
references:
- type: ADVISORY
  url: https://api.osv.dev/v1/vulns/CVE-2024-45287
- type: ADVISORY
  url: https://www.freebsd.org/security/advisories/FreeBSD-SA-24:16.libnv.asc
affected:
- package:
    ecosystem: FreeBSD:ports
    name: FreeBSD
  ranges:
  - type: ECOSYSTEM
    events:
    - introduced: '14.1'
    - fixed: '14.1_5'
  - type: ECOSYSTEM
    events:
    - introduced: '14.0'
    - fixed: '14.0_11'
  - type: ECOSYSTEM
    events:
    - introduced: '13.4'
    - fixed: '13.4_1'
  - type: ECOSYSTEM
    events:
    - introduced: '13.3'
    - fixed: '13.3_7'
database_specific:
  vid: 93c12fe5-7716-11ef-9a62-002590c1f29c
  discovery: '2024-09-19T00:00:00Z'
id: FBSD-2024-0101
