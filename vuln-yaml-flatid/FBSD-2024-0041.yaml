schema_version: 1.7.0
modified: '2024-11-14T00:00:00Z'
published: '2024-11-14T00:00:00Z'
summary: PostgreSQL -- SET ROLE, SET SESSION AUTHORIZATION reset to wrong user 
  ID
details: |-
  PostgreSQL project reports:

  > Incorrect privilege assignment in PostgreSQL allows a
  > less-privileged application user to view or change
  > different rows from those intended. An attack requires
  > the application to use SET ROLE, SET SESSION
  > AUTHORIZATION, or an equivalent feature. The problem
  > arises when an application query uses parameters from
  > the attacker or conveys query results to the attacker.
  > If that query reacts to current\_setting('role') or the
  > current user ID, it may modify or return data as though
  > the session had not used SET ROLE or SET SESSION
  > AUTHORIZATION. The attacker does not control which
  > incorrect user ID applies. Query text from
  > less-privileged sources is not a concern here, because
  > SET ROLE and SET SESSION AUTHORIZATION are not sandboxes
  > for unvetted queries
references:
- type: ADVISORY
  url: https://api.osv.dev/v1/vulns/CVE-2024-10978
- type: WEB
  url: https://www.postgresql.org/support/security/CVE-2024-10978/
affected:
- package:
    ecosystem: FreeBSD:ports
    name: postgresql16-server
  ranges:
  - type: ECOSYSTEM
    events:
    - fixed: '16.5'
    - introduced: '0'
- package:
    ecosystem: FreeBSD:ports
    name: postgresql15-server
  ranges:
  - type: ECOSYSTEM
    events:
    - fixed: '15.9'
    - introduced: '0'
- package:
    ecosystem: FreeBSD:ports
    name: postgresql14-server
  ranges:
  - type: ECOSYSTEM
    events:
    - fixed: '14.14'
    - introduced: '0'
- package:
    ecosystem: FreeBSD:ports
    name: postgresql13-server
  ranges:
  - type: ECOSYSTEM
    events:
    - fixed: '13.17'
    - introduced: '0'
- package:
    ecosystem: FreeBSD:ports
    name: postgresql12-server
  ranges:
  - type: ECOSYSTEM
    events:
    - fixed: '12.21'
    - introduced: '0'
database_specific:
  vid: 12e3feab-a29f-11ef-af48-6cc21735f730
  discovery: '2024-11-14T00:00:00Z'
id: FBSD-2024-0041
