schema_version: 1.7.0
modified: '2025-01-30T00:00:00Z'
published: '2025-01-30T00:00:00Z'
summary: FreeBSD -- Buffer overflow in some filesystems via NFS
details: |-
  Problem Description:
  ====================

  In order to export a file system via NFS, the file system must
  define a file system identifier (FID) for all exported files. Each
  FreeBSD file system implements operations to translate between FIDs
  and vnodes, the kernel's in-memory representation of files. These
  operations are VOP\_VPTOFH(9) and VFS\_FHTOVP(9).

  On 64-bit systems, the implementation of VOP\_VPTOFH() in the
  cd9660, tarfs and ext2fs filesystems overflows the destination FID
  buffer by 4 bytes, a stack buffer overflow.

  Impact:
  =======

  A NFS server that exports a cd9660, tarfs, or ext2fs file system
  can be made to panic by mounting and accessing the export with an
  NFS client. Further exploitation (e.g., bypassing file permission
  checking or remote kernel code execution) is potentially possible,
  though this has not been demonstrated. In particular, release
  kernels are compiled with stack protection enabled, and some instances
  of the overflow are caught by this mechanism, causing a panic.
references:
- type: ADVISORY
  url: https://api.osv.dev/v1/vulns/CVE-2025-0373
- type: ADVISORY
  url: https://www.freebsd.org/security/advisories/FreeBSD-SA-25:02.fs.asc
affected: []
database_specific:
  vid: ab0cbe3f-debc-11ef-87ba-002590c1f29c
  discovery: '2025-01-29T00:00:00Z'
id: FBSD-2025-0243
