schema_version: 1.7.0
modified: '2024-09-05T00:00:00Z'
published: '2024-09-05T00:00:00Z'
summary: FreeBSD -- bhyve(8) privileged guest escape via USB controller
details: |-
  Problem Description:
  ====================

  bhyve can be configured to emulate devices on a virtual USB
  controller (XHCI), such as USB tablet devices. An insufficient
  boundary validation in the USB code could lead to an out-of-bounds
  write on the heap, with data controlled by the caller.

  Impact:
  =======

  A malicious, privileged software running in a guest VM can
  exploit the vulnerability to achieve code execution on the host in
  the bhyve userspace process, which typically runs as root. Note
  that bhyve runs in a Capsicum sandbox, so malicious code is constrained
  by the capabilities available to the bhyve process.
references:
- type: ADVISORY
  url: https://api.osv.dev/v1/vulns/CVE-2024-32668
- type: ADVISORY
  url: https://www.freebsd.org/security/advisories/FreeBSD-SA-24:12.bhyve.asc
affected: []
database_specific:
  vid: 4edaa9f4-6b51-11ef-9a62-002590c1f29c
  discovery: '2024-09-04T00:00:00Z'
id: FBSD-2024-0121
